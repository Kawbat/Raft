MIT 6.824 implementation